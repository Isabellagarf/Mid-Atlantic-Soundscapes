---
output: html_document
editor_options: 
  chunk_output_type: console
---
title: "A.E.Smith Mid-Atlantic Fish Chorusing"
author: "Anne E. Smith"
date: "2025-08-12"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## libraries

```{r}
library(PAMscapes)
library(ggplot2)
library(tidyverse)
library(lubridate)
library(here)
library(dplyr)
library(car)
library(patchwork)
library(ggpubr)
library(rstatix)
library(PAMmisc)
library(dunn.test)
library(smplot2)
library(tsibble)
library(scales)
library(ggpmisc)
library(paletteer)
library(ggh4x)
library(suntools)
library(zoo)
library(wesanderson)

```

# loading full HMD files per site

```{r}
#all_sites_HMD <- read.csv(here("data/all_sites_HMD.csv"))
#runSoundscapeExplorer(all_sites_HMD)

DB01_HMD <- read.csv(here("data/DB01_HMD.csv"))
DB01_HMD$UTC <- as.POSIXct(DB01_HMD$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB01_HMD$PLATFORM = "DB01"
DB02_HMD <- read.csv(here("data/DB02_HMD.csv"))
DB02_HMD$UTC <- as.POSIXct(DB02_HMD$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB02_HMD$PLATFORM = "DB02"
DB03_HMD <- read.csv(here("data/DB03_HMD.csv"))
DB03_HMD$UTC <- as.POSIXct(DB03_HMD$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB03_HMD$PLATFORM = "DB03"

ES01_HMD <- read.csv(here("data/ES01_HMD.csv"))
ES01_HMD$UTC <- as.POSIXct(ES01_HMD$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
ES01_HMD$PLATFORM = "ES01"
ES02_HMD <- read.csv(here("data/ES02_HMD.csv"))
ES02_HMD$UTC <- as.POSIXct(ES02_HMD$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
ES02_HMD$PLATFORM = "ES02"
ES03_HMD <- read.csv(here("data/ES03_HMD.csv"))
ES03_HMD$UTC <- as.POSIXct(ES03_HMD$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
ES03_HMD$PLATFORM = "ES03"

CB01_HMD <- read.csv(here("data/CB01_HMD.csv"))
CB01_HMD$UTC <- as.POSIXct(CB01_HMD$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB01_HMD$PLATFORM = "CB01"
CB02_HMD <- read.csv(here("data/dataCB02_HMD.csv"))
CB02_HMD$UTC <- as.POSIXct(CB02_HMD$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB02_HMD$PLATFORM = "CB02"
CB03_HMD <- read.csv(here("data/dataCB03_HMD.csv"))
CB03_HMD$UTC <- as.POSIXct(CB03_HMD$UTC, format= "%m/%d/%Y %H", tz = "GMT")
CB03_HMD <- CB03_HMD[-c(1)]
CB03_HMD$PLATFORM = "CB03"

all_sites <- DB01_HMD%>%
  full_join(DB02_HMD)%>%
  full_join(DB03_HMD)%>%
  full_join(ES01_HMD)%>%
  full_join(ES02_HMD)%>%
  full_join(ES03_HMD)%>%
  full_join(CB01_HMD)%>%
  full_join(CB02_HMD)%>%
  full_join(CB03_HMD)
all_sites$PLATFORM_order= factor(all_sites$PLATFORM, levels = c("DB01","DB02","DB03","ES01","ES02", "ES03", "CB01", "CB02","CB03"))

#write.csv(all_sites, here("data", "all_sites_HMD.csv")) #need to save after joining all sites again


```

# all sites
```{r}
all_sites <- inshore_sites %>%
  full_join(midshore_sites)%>%
  full_join(offshore_sites)

runSoundscapeExplorer(all_sites)

allSites_LTSA = plotLTSA(x=all_sites, facet= 'PLATFORM') +
  facet_grid(~factor(PLATFORM, levels = c('DB01', 'DB02', 'DB03', 'ES01', 'ES02', 'ES03', 'CB01', 'CB02', 'CB03')))+
  theme_bw()

plot(allSites_LTSA)
plotPSD(x=all_sites, style='quantile', q=0, by='month', facet='PLATFORM')+
  scale_color_manual(values= c("#a6cee3", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99", "#e31a1c", "#fdbf6f", "#ffff99", "#ff7f00", "#cab2d6", "#6a3d9a", "#b15928"))
  scale_fill_manual(values= wes_palette("Royal1", n= 4))


```

#inshore/offshore grouping

```{r}
#load back in csv from data folder next time!

inshore_sites <- DB01_HMD %>%
  full_join(ES01_HMD)%>%
  full_join(CB01_HMD)

midshore_sites <- DB02_HMD %>%
  full_join(ES02_HMD)%>%
  full_join(CB02_HMD)%>%
  full_join(CB03_HMD)

offshore_sites <- DB03_HMD %>%
  full_join(ES03_HMD)

DB_sites <- DB01_HMD %>%
  full_join(DB02_HMD)%>%
  full_join(DB03_HMD)
ES_sites <- ES01_HMD %>%
  full_join(ES02_HMD)%>%
  full_join(ES03_HMD)
CB_sites <- CB01_HMD %>% #will need to redo when CB02 error is fixed
  full_join(CB02_HMD)%>%
  full_join(CB03_HMD)
```

#plotting sites by group

```{r}

runSoundscapeExplorer(DB_sites)

plotPSD(x=midshore_sites, style='quantile', q=0.01, by='PLATFORM', facet='month')+
  labs(y= (expression(paste("Power Spectral Density dB re 1 \u00b5Pa" ^ "2", "/Hz"))))+
  theme(axis.text= element_text(size= 10),
        axis.title= element_text(size= 14),
        legend.text = element_text(size= 13),
        legend.title= element_text(size= 13.5),
        strip.text= element_text(size= 12))+
  scale_color_manual(labels= c("DB02", "ES02", "CB02", "CB03"), values= c("#00797F90","#00308790", "#B7130090", "#B7130080"))+
  scale_fill_manual(values= c("#00797F90","#00308790", "#B7130090"))+
  theme_bw()+
  guides(color= guide_legend(title= "Platform"))


plotPSD(x=offshore_sites, style='quantile', q=0.01, facet='PLATFORM')+
  labs(y= (expression(paste("Power Spectral Density dB re 1 \u00b5Pa" ^ "2", "/Hz"))))+
  theme(axis.text= element_text(size= 12),
        axis.title= element_text(size= 14),
        legend.text = element_text(size= 13),
        legend.title= element_text(size= 13.5),
        strip.text= element_text(size= 12))
guides(color= guide_legend(title= "Month")) #add back to plot if using other PSDs


DB_plot <- plotPSD(DB_sites, 
                     style = "quantile",
                     scale = "log",
                     q = 0.1,
                     color = "black",
                     units = expression(paste("dB re 1", mu, "Pa"^"2", "Hz"^"-1")),
                     freqRange = c(20,24000),
                     by = c("PLATFORM"))

DB_plot +
   scale_color_viridis_d(option = "mako", begin = 0.25, end = 0.75)+
   scale_fill_viridis_d(option = "mako", begin = 0.25, end = 0.75)+
   labs(color="Platform") +
   theme_bw()

ES_plot <- plotPSD(ES_sites, 
                     style = "quantile",
                     scale = "log",
                     q = 0.1,
                     color = "black",
                     units = expression(paste("dB re 1", mu, "Pa"^"2", "Hz"^"-1")),
                     freqRange = c(20,24000),
                     by = c("PLATFORM"))

ES_plot +
   scale_color_viridis_d(option = "mako", begin = 0.25, end = 0.75)+
   scale_fill_viridis_d(option = "mako", begin = 0.25, end = 0.75)+
   labs(color="Platform") +
   theme_bw()

inshore_plot <-  plotPSD(inshore_sites, 
                     style = "quantile",
                     scale = "log",
                     q = 0.1,
                     color = "black",
                     units = expression(paste("dB re 1", mu, "Pa"^"2", "Hz"^"-1")),
                     freqRange = c(20,24000),
                     by = c("PLATFORM"))
inshore_plot +
   scale_color_viridis_d(option = "magma", begin = 0.25, end = 0.75)+
   scale_fill_viridis_d(option = "magma", begin = 0.25, end = 0.75)+
   labs(color="Platform") +
   theme_bw()

midshore_plot <- plotPSD(midshore_sites,
                         style= "quantile",
                         scale= "log",
                         q= 0.1,
                         color= "black",
                         units= expression(paste("dB re 1", mu, "Pa"^"2", "Hz"^"-1")),
                         freqRange= c(20,24000),
                         by = c("PLATFORM"))
midshore_plot +
  scale_color_viridis_d(option= "magma", begin = 0.25, end = 0.75)+
  scale_fill_viridis_d(option = "magma", begin = 0.25, end = 0.75)+
  labs(color= "Platform")+
  theme_bw()

offshore_plot <- plotPSD(offshore_sites,
                         style= "quantile",
                         scale= "log",
                         q= 0.1,
                         color= "black",
                         units= expression(paste("dB re 1", mu, "Pa"^"2", "Hz"^"-1")),
                         freqRange= c(20,24000),
                         by = c("PLATFORM"))
offshore_plot +
  scale_color_viridis_d(option= "magma", begin = 0.25, end = 0.75)+
  scale_fill_viridis_d(option = "magma", begin = 0.25, end = 0.75)+
  labs(color= "Platform")+
  theme_bw()
  

```

#plots by specific months

```{r}
offshore_sites$month_num <- month(offshore_sites$UTC)
inshore_sites$month_num <- month(inshore_sites$UTC)
midshore_sites$month_num <- month(midshore_sites$UTC)

data_subset <- USArrests %>% filter(UrbanPop > 70)
plot(data_subset$Murder, data_subset$Assault)
inshore_chorusingMonths <- inshore_sites %>%
  filter(inshore_sites$month_num > 5 & inshore_sites$month_num <11)

inshore_chorusMonths_plot <- plotPSD(inshore_chorusingMonths,
                                     style= "quantile",
                                     scale= "log",
                                     color= "black",
                                     units= expression(paste("dB re 1", mu, "Pa"^"2", "Hz"^"-1")),
                                     freqRange= c(20,24000),
                                     by ="month",
                                     facet= 'PLATFORM')
inshore_chorusMonths_plot+
  scale_color_viridis_d(option = "magma", begin = 0.25, end = 0.75)+
  scale_fill_viridis_d(option= "magma", begin = 0.25, end = 0.75)+
  labs(color= "Month")+
  theme_bw()

#individual months
inshore_july_plot <- plotPSD(inshore_sites [inshore_sites$month_num == "7",],
                     style = "quantile",
                     scale = "log",
                     color = "black",
                     units = expression(paste("dB re 1", mu, "Pa"^"2", "Hz"^"-1")),
                     freqRange = c(20,24000),
                     by = 'month',
                   facet= 'PLATFORM')

inshore_july_plot +
   scale_color_viridis_d(option = "mako", begin = 0.25, end = 0.75)+
   scale_fill_viridis_d(option = "mako", begin = 0.25, end = 0.75)+
   labs(color="Month") +
   theme_bw()

```

## OCTAVE LEVEL FILES
```{r}
DB01_OL <- read.csv(here("data/DB01_OL.csv"))
DB01_OL <- DB01_OL[-c(1)]
DB01_OL$UTC_fixed <- paste(DB01_OL$UTC_date, DB01_OL$UTC_hour, sep = " ")
DB01_OL$UTC_fixed <- as.POSIXct(DB01_OL$UTC_fixed, format = "%Y-%m-%d %H:%M:%S")
DB01_OL$PLATFORM = "DB01"

DB02_OL <- read.csv(here("data/DB02_OL.csv"))
DB02_OL <- DB02_OL[-c(1)]
DB02_OL$UTC_fixed <- paste(DB02_OL$UTC_date, DB02_OL$UTC_hour, sep = " ")
DB02_OL$UTC_fixed <- as.POSIXct(DB02_OL$UTC_fixed, format = "%Y-%m-%d %H:%M:%S")
DB02_OL$PLATFORM = "DB02"

DB03_OL <- read.csv(here("data/DB03_OL.csv"))
DB03_OL <- DB03_OL[-c(1)]
DB03_OL$UTC_fixed <- paste(DB03_OL$UTC_date, DB03_OL$UTC_hour, sep = " ")
DB03_OL$UTC_fixed <- as.POSIXct(DB03_OL$UTC_fixed, format = "%Y-%m-%d %H:%M:%S")
DB03_OL$PLATFORM = "DB03"

ES01_OL <- read.csv(here("data/ES01_OL.csv"))
ES01_OL <- ES01_OL[-c(1)]
ES01_OL$UTC_fixed <- paste(ES01_OL$UTC_date, ES01_OL$UTC_hour, sep = " ")
ES01_OL$UTC_fixed <- as.POSIXct(ES01_OL$UTC_fixed, format = "%Y-%m-%d %H:%M:%S")
ES01_OL$PLATFORM = "ES01"

ES02_OL <- read.csv(here("data/ES02_OL.csv"))
ES02_OL <- ES02_OL[-c(1)]
ES02_OL$UTC_fixed <- paste(ES02_OL$UTC_date, ES02_OL$UTC_hour, sep = " ")
ES02_OL$UTC_fixed <- as.POSIXct(ES02_OL$UTC_fixed, format = "%Y-%m-%d %H:%M:%S")
ES02_OL$PLATFORM = "ES02"

ES03_OL <- read.csv(here("data/ES03_OL.csv"))
ES03_OL <- ES03_OL[-c(1)]
ES03_OL$UTC_fixed <- paste(ES03_OL$UTC_date, ES03_OL$UTC_hour, sep = " ")
ES03_OL$UTC_fixed <- as.POSIXct(ES03_OL$UTC_fixed, format = "%Y-%m-%d %H:%M:%S")
ES03_OL$PLATFORM = "ES03"

CB01_OL <- read.csv(here("data/CB01_OL.csv"))
CB01_OL <- CB01_OL[-c(1)]
CB01_OL$UTC_fixed <- paste(CB01_OL$UTC_date, CB01_OL$UTC_hour, sep = " ")
CB01_OL$UTC_fixed <- as.POSIXct(CB01_OL$UTC_fixed, format = "%Y-%m-%d %H:%M:%S")
CB01_OL$PLATFORM = "CB01"

CB02_OL <- read.csv(here("data/CB02_OL.csv"))
CB02_OL <- CB02_OL[-c(1)]
CB02_OL$UTC_fixed <- paste(CB02_OL$UTC_date, CB02_OL$UTC_hour, sep = " ")
CB02_OL$UTC_fixed <- as.POSIXct(CB02_OL$UTC_fixed, format = "%Y-%m-%d %H:%M:%S")
CB02_OL$PLATFORM = "CB02"

CB03_OL <- read.csv(here("data/CB03_OL.csv"))
CB03_OL <- CB03_OL[-c(1)]
CB03_OL$UTC_fixed <- paste(CB03_OL$UTC_date, CB03_OL$UTC_hour, sep = " ")
CB03_OL$UTC_fixed <- as.POSIXct(CB03_OL$UTC_fixed, format = "%Y-%m-%d %H:%M:%S")
CB03_OL$PLATFORM = "CB03"


```

# inshore/offshore gradient using OL

```{r}
inshore_sites_OL <- DB01_OL %>%
  full_join(ES01_OL)%>%
  full_join(CB01_OL)


ggplot(inshore_sites_OL, aes(x= UTC_fixed, y= OL_500, color = PLATFORM))+
  geom_line()+
  theme_bw()+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
  scale_color_manual(values= c("#00797F90","#00308790", "#B7130090"))
```

#only plotting sunset hours

```{r}
#DB01
DB01_location <- matrix(c(-74.82, 38.71), nrow = 1)
DB01_date_Time <- seq(ymd_hms("2022-06-10 00:00:00"), ymd_hms("2024-11-08 16:00:00"), by = "1 hour")

Sunset <- sunriset(crds = DB01_location, dateTime = DB01_date_Time, direction = "sunset", POSIXct.out = TRUE)
sunset_datehour <- Sunset %>%
  mutate(UTC_date = date(time))%>%
  mutate(sunset_UTC_hour = hour(time))

sunset_datehour <- sunset_datehour %>%
  group_by(UTC_date, sunset_UTC_hour)%>%
  summarize(n = n())
sunset_datehour$sunset_UTC_hour <- as.character(sunset_datehour$sunset_UTC_hour)
sunset_datehour$UTC_date <- as.character(sunset_datehour$UTC_date)
sunset_datehour <- sunset_datehour[-c(3)]
sunset_datehour$UTC_fixed <- paste(sunset_datehour$UTC_date, sunset_datehour$sunset_UTC_hour, sep = " ")
sunset_datehour$UTC_fixed = as.POSIXct(sunset_datehour$UTC_fixed, format = "%Y-%m-%d %H")


DB01_sunset <- DB01_OL %>%
  right_join(sunset_datehour, join_by(UTC_fixed))

DB01_500Hz <- ggplot(DB01_sunset, aes(x= UTC_fixed, y= OL_500))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))
DB01_2000Hz <- ggplot(DB01_sunset, aes(x= UTC_fixed, y= OL_2000))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))

DB01_500Hz/DB01_2000Hz +plot_layout(guides = "collect", axis_titles = "collect")

#ES01
ES01_location <- matrix(c(-75.29, 37.69), nrow = 1)
ES01_date_Time <- seq(ymd_hms("2023-10-13 00:00:00"), ymd_hms("2024-09-29 18:00:00"), by = "1 hour")

ES01Sunset <- sunriset(crds = ES01_location, dateTime = ES01_date_Time, direction = "sunset", POSIXct.out = TRUE)
ES01sunset_datehour <- ES01Sunset %>%
  mutate(UTC_date = date(time))%>%
  mutate(sunset_UTC_hour = hour(time))
ES01sunset_datehour <- ES01sunset_datehour %>%
  group_by(UTC_date, sunset_UTC_hour)%>%
  summarize(n = n())
ES01sunset_datehour$sunset_UTC_hour <- as.character(ES01sunset_datehour$sunset_UTC_hour)
ES01sunset_datehour$UTC_date <- as.character(ES01sunset_datehour$UTC_date)
ES01sunset_datehour <- ES01sunset_datehour[-c(3)]
ES01sunset_datehour$UTC_fixed <- paste(ES01sunset_datehour$UTC_date, ES01sunset_datehour$sunset_UTC_hour, sep = " ")
ES01sunset_datehour$UTC_fixed = as.POSIXct(ES01sunset_datehour$UTC_fixed, format = "%Y-%m-%d %H")

ES01_sunset <- ES01_OL %>%
  right_join(ES01sunset_datehour, join_by(UTC_fixed))

ES01_500Hz <- ggplot(ES01_sunset, aes(x= UTC_fixed, y= OL_500))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))
ES01_2000Hz <- ggplot(ES01_sunset, aes(x= UTC_fixed, y= OL_2000))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))

ES01_500Hz/ES01_2000Hz +plot_layout(guides = "collect", axis_titles = "collect")


#CB01
CB01_location <- matrix(c(-75.67, 36.98), nrow = 1)
CB01_date_Time <- seq(ymd_hms("2022-06-10 00:00:00"), ymd_hms("2024-11-08 16:00:00"), by = "1 hour")

CB01Sunset <- sunriset(crds = CB01_location, dateTime = CB01_date_Time, direction = "sunset", POSIXct.out = TRUE)
CB01sunset_datehour <- CB01Sunset %>%
  mutate(UTC_date = date(time))%>%
  mutate(sunset_UTC_hour = hour(time))
CB01sunset_datehour <- CB01sunset_datehour %>%
  group_by(UTC_date, sunset_UTC_hour)%>%
  summarize(n = n())
CB01sunset_datehour$sunset_UTC_hour <- as.character(CB01sunset_datehour$sunset_UTC_hour)
CB01sunset_datehour$UTC_date <- as.character(CB01sunset_datehour$UTC_date)
CB01sunset_datehour <- CB01sunset_datehour[-c(3)]
CB01sunset_datehour$UTC_fixed <- paste(CB01sunset_datehour$UTC_date, CB01sunset_datehour$sunset_UTC_hour, sep = " ")
CB01sunset_datehour$UTC_fixed = as.POSIXct(CB01sunset_datehour$UTC_fixed, format = "%Y-%m-%d %H")

CB01_sunset <- CB01_OL %>%
  right_join(CB01sunset_datehour, join_by(UTC_fixed))

CB01_500Hz <- ggplot(CB01_sunset, aes(x= UTC_fixed, y= OL_500))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))
CB01_2000Hz <- ggplot(CB01_sunset, aes(x= UTC_fixed, y= OL_2000))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))

CB01_500Hz/CB01_2000Hz +plot_layout(guides = "collect", axis_titles = "collect")



#ALL INSHORE

inshore_sunsets <- DB01_sunset %>%
  full_join(ES01_sunset) %>%
  full_join(CB01_sunset)

ggplot(inshore_sunsets, aes(x= UTC_fixed, y= OL_500, color= PLATFORM))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))

ggplot(inshore_sunsets, aes(x= UTC_fixed, y= OL_2000, color= PLATFORM))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))

```

# plotting sunrise

```{r}
#DB01
DB01_location <- matrix(c(-74.82, 38.71), nrow = 1)
DB01_date_Time <- seq(ymd_hms("2022-06-10 00:00:00"), ymd_hms("2024-11-08 16:00:00"), by = "1 hour")

DB01Sunrise <- sunriset(crds = DB01_location, dateTime = DB01_date_Time, direction = "sunrise", POSIXct.out = TRUE)
DB01sunrise_datehour <- DB01Sunrise %>%
  mutate(UTC_date = date(time))%>%
  mutate(sunrise_UTC_hour = hour(time))

DB01sunrise_datehour <- DB01sunrise_datehour %>%
  group_by(UTC_date, sunrise_UTC_hour)%>%
  summarize(n = n())
DB01sunrise_datehour$sunrise_UTC_hour <- as.character(DB01sunrise_datehour$sunrise_UTC_hour)
DB01sunrise_datehour$UTC_date <- as.character(DB01sunrise_datehour$UTC_date)
DB01sunrise_datehour <- DB01sunrise_datehour[-c(3)]
DB01sunrise_datehour$UTC_fixed <- paste(DB01sunrise_datehour$UTC_date, DB01sunrise_datehour$sunrise_UTC_hour, sep = " ")
DB01sunrise_datehour$UTC_fixed = as.POSIXct(DB01sunrise_datehour$UTC_fixed, format = "%Y-%m-%d %H")


DB01_sunrise <- DB01_OL %>%
  right_join(DB01sunrise_datehour, join_by(UTC_fixed))

DB01_500Hz <- ggplot(DB01_suntimes, aes(x= UTC_fixed, y= OL_500, color= sun_time))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
#  geom_smooth(aes(group=1,2))+
  scale_color_manual(values= c("#00308790", "#B7130090"))+
  ggtitle("DB01")+
  theme(legend.title= element_blank())+
  ylim(72, 135)
DB01_2000Hz <- ggplot(DB01_suntimes, aes(x= UTC_fixed, y= OL_2000, color= sun_time))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
#  geom_smooth(aes(group=1,2))+
  scale_color_manual(values= c("#00308790", "#B7130090"))+
  theme(legend.title= element_blank())+
  ggtitle("DB01")+
  ylim(72, 135)

DB01_500Hz/DB01_2000Hz +plot_layout(guides = "collect", axis_titles = "collect")

DB01_sunset$sun_time = "Sunset"
DB01_sunrise$sun_time = "Sunrise"
DB01_suntimes <- DB01_sunrise %>%
  full_join(DB01_sunset)

ggplot(DB01_suntimes, aes(x= UTC_fixed, y= OL_500, color= sun_time, ))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
  scale_color_manual(values= c("#00308790", "#B7130090"))


ggplot(DB01_suntimes, aes(x= UTC_fixed, y= OL_2000, color=sun_time, q=0.01))+
  geom_line()+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
  scale_color_manual(values= c("#00308790", "#B7130090"))+
  scale_fill_manual(values= c("#00308790", "#B7130090"))
  


runSoundscapeExplorer(ES01_suntimes)
```
#ES01

```{r}
#ES01
ES01_location <- matrix(c(-75.29, 37.69), nrow = 1)
ES01_date_Time <- seq(ymd_hms("2022-06-10 00:00:00"), ymd_hms("2024-11-08 16:00:00"), by = "1 hour")

ES01Sunrise <- sunriset(crds = ES01_location, dateTime = ES01_date_Time, direction = "sunrise", POSIXct.out = TRUE)
ES01sunrise_datehour <- ES01Sunrise %>%
  mutate(UTC_date = date(time))%>%
  mutate(sunrise_UTC_hour = hour(time))

ES01sunrise_datehour <- ES01sunrise_datehour %>%
  group_by(UTC_date, sunrise_UTC_hour)%>%
  summarize(n = n())
ES01sunrise_datehour$sunrise_UTC_hour <- as.character(ES01sunrise_datehour$sunrise_UTC_hour)
ES01sunrise_datehour$UTC_date <- as.character(ES01sunrise_datehour$UTC_date)
ES01sunrise_datehour <- ES01sunrise_datehour[-c(3)]
ES01sunrise_datehour$UTC_fixed <- paste(ES01sunrise_datehour$UTC_date, ES01sunrise_datehour$sunrise_UTC_hour, sep = " ")
ES01sunrise_datehour$UTC_fixed = as.POSIXct(ES01sunrise_datehour$UTC_fixed, format = "%Y-%m-%d %H")

ES01_sunrise <- ES01_OL %>%
  right_join(ES01sunrise_datehour, join_by(UTC_fixed))

ES01_sunset$sun_time = "Sunset"
ES01_sunrise$sun_time = "Sunrise"
ES01_suntimes <- ES01_sunrise %>%
  full_join(ES01_sunset)

ES01_500Hz <- ggplot(ES01_suntimes, aes(x= UTC_fixed, y= OL_500, color= sun_time))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
#  geom_smooth(aes(group=1,2))+
  scale_color_manual(values= c("#00308790", "#B7130090"))+
  ggtitle("ES01")+
  theme(legend.title= element_blank())+
  ylim(72, 135)
ES01_2000Hz <- ggplot(ES01_suntimes, aes(x= UTC_fixed, y= OL_2000, color= sun_time))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
#  geom_smooth(aes(group=1,2))+
  scale_color_manual(values= c("#00308790", "#B7130090"))+
  theme(legend.title= element_blank())+
  ggtitle("ES01")+
  ylim(72, 135)

ES01_500Hz/ES01_2000Hz +plot_layout(guides = "collect", axis_titles = "collect")


```
#CB01 and combining

```{r}
#CB01
CB01_location <- matrix(c(-75.67, 36.98), nrow = 1)
CB01_date_Time <- seq(ymd_hms("2022-06-10 00:00:00"), ymd_hms("2024-11-08 16:00:00"), by = "1 hour")

CB01Sunrise <- sunriset(crds = CB01_location, dateTime = CB01_date_Time, direction = "sunrise", POSIXct.out = TRUE)
CB01sunrise_datehour <- CB01Sunrise %>%
  mutate(UTC_date = date(time))%>%
  mutate(sunrise_UTC_hour = hour(time))

CB01sunrise_datehour <- CB01sunrise_datehour %>%
  group_by(UTC_date, sunrise_UTC_hour)%>%
  summarize(n = n())
CB01sunrise_datehour$sunrise_UTC_hour <- as.character(CB01sunrise_datehour$sunrise_UTC_hour)
CB01sunrise_datehour$UTC_date <- as.character(CB01sunrise_datehour$UTC_date)
CB01sunrise_datehour <- CB01sunrise_datehour[-c(3)]
CB01sunrise_datehour$UTC_fixed <- paste(CB01sunrise_datehour$UTC_date, CB01sunrise_datehour$sunrise_UTC_hour, sep = " ")
CB01sunrise_datehour$UTC_fixed = as.POSIXct(CB01sunrise_datehour$UTC_fixed, format = "%Y-%m-%d %H")

CB01_sunrise <- CB01_OL %>%
  right_join(CB01sunrise_datehour, join_by(UTC_fixed))

CB01_sunset$sun_time = "Sunset"
CB01_sunrise$sun_time = "Sunrise"
CB01_suntimes <- CB01_sunrise %>%
  full_join(CB01_sunset)

CB01_500Hz <- ggplot(CB01_suntimes, aes(x= UTC_fixed, y= OL_500, color= sun_time))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
#  geom_smooth(aes(group=1,2))+
  scale_color_manual(values= c("#00308790", "#B7130090"))+
  ggtitle("CB01")+
  theme(legend.title= element_blank())+
  ylim(72, 135)
CB01_2000Hz <- ggplot(CB01_suntimes, aes(x= UTC_fixed, y= OL_2000, color= sun_time))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
#  geom_smooth(aes(group=1,2))+
  scale_color_manual(values= c("#00308790", "#B7130090"))+
  theme(legend.title= element_blank())+
  ggtitle("CB01")+
  ylim(72, 135)

runSoundscapeExplorer(DB01_suntimes)

CB01_500Hz/CB01_2000Hz +plot_layout(guides = "collect", axis_titles = "collect")


DB01_2000Hz/ES01_2000Hz/CB01_2000Hz +plot_layout(guides= "collect", axis_titles= "collect")


CB01_1000Hz <- ggplot(CB01_suntimes, aes(x= UTC_fixed, y= OL_1000, color= sun_time))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "2 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 1000Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
#  geom_smooth(aes(group=1,2))+
  scale_color_manual(values= c("#00308790", "#B7130090"))+
  theme(legend.title= element_blank())+
  ggtitle("CB01")+
  ylim(72, 135)

DB01_1000Hz <- ggplot(DB01_suntimes, aes(x= UTC_fixed, y= OL_1000, color= sun_time))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "2 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 1000Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
#  geom_smooth(aes(group=1,2))+
  scale_color_manual(values= c("#00308790", "#B7130090"))+
  theme(legend.title= element_blank())+
  ggtitle("DB01")+
  ylim(72, 135)

ES01_1000Hz <- ggplot(ES01_suntimes, aes(x= UTC_fixed, y= OL_1000, color= sun_time))+
  geom_line(linewidth = 0.75)+
  scale_x_datetime(date_breaks = "2 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  xlab("Date")+
  ylab(expression(paste('Median 1000Hz Octave Level SPL (db re 1 \u00b5Pa)')))+
#  geom_smooth(aes(group=1,2))+
  scale_color_manual(values= c("#00308790", "#B7130090"))+
  theme(legend.title= element_blank())+
  ggtitle("ES01")+
  ylim(72, 135)

DB01_1000Hz/ES01_1000Hz/CB01_1000Hz +plot_layout(guides= "collect", axis_titles= "collect")
```

#OL_500 Delaware

```{r}
#make more data so DB03 starts at same time
subset_OL_DB03 <- seq(ymd_hms("2022-07-07 00:00:00"), ymd_hms("2023-01-10 23:00:00"), by = "1 hour")
subset_OL_DB03 <- data.frame(UTC= subset_OL_DB03)
DB03_OL <- DB03_OL%>%
  full_join(subset_OL_DB03, by= join_by(UTC))

DB01_OL_plot<- ggplot(DB01_OL, aes(x= UTC, y= OL_500))+
  geom_line()+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  ylim(72, 140)+
  annotate("text", x= as.POSIXct("2022-07-10 00:00"), y= 135, label= "DB01", color= "black", size= 5)+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))

DB02_OL_plot <- ggplot(DB02_OL, aes(x= UTC, y= OL_500))+
  geom_line()+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  ylim(72, 140)+
  annotate("text", x= as.POSIXct("2022-07-10 00:00"), y= 135, label= "DB02", color= "black", size= 5)+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))

DB03_OL_plot <- ggplot(DB03_OL, aes(x= UTC, y= OL_500))+
  geom_line()+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  ylim(72, 140)+
  annotate("text", x= as.POSIXct("2022-07-10 00:00"), y= 135, label= "DB03", color= "black", size= 5)+
  xlab("Date")+
  ylab(expression(paste('Median 500Hz Octave Level SPL (db re 1 \u00b5Pa)')))

DB01_OL_plot/DB02_OL_plot/DB03_OL_plot + plot_layout(axis_titles = "collect", guides = "collect", design = "AA\nBB\nCC")

```

#OL_2000 Delaware

```{r}

#make more data so DB03 starts at same time
subset_OL_DB03 <- seq(ymd_hms("2022-07-07 00:00:00"), ymd_hms("2023-01-10 23:00:00"), by = "1 hour")
subset_OL_DB03 <- data.frame(UTC= subset_OL_DB03)
DB03_OL <- DB03_OL%>%
  full_join(subset_OL_DB03, by= join_by(UTC))

DB01_2000OL_plot<- ggplot(DB01_OL, aes(x= UTC, y= OL_2000))+
  geom_line()+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  ylim(72, 140)+
  annotate("text", x= as.POSIXct("2022-07-10 00:00"), y= 135, label= "DB01", color= "black", size= 5)+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))

DB02_2000OL_plot <- ggplot(DB02_OL, aes(x= UTC, y= OL_2000))+
  geom_line()+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  ylim(72, 140)+
  annotate("text", x= as.POSIXct("2022-07-10 00:00"), y= 135, label= "DB02", color= "black", size= 5)+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))

DB03_2000OL_plot <- ggplot(DB03_OL, aes(x= UTC, y= OL_2000))+
  geom_line()+
  scale_x_datetime(date_breaks = "3 months", date_labels= "%b %Y", minor_breaks = NULL)+
  theme_bw()+
  ylim(72, 140)+
  annotate("text", x= as.POSIXct("2022-07-10 00:00"), y= 135, label= "DB03", color= "black", size= 5)+
  xlab("Date")+
  ylab(expression(paste('Median 2000Hz Octave Level SPL (db re 1 \u00b5Pa)')))

DB01_2000OL_plot/DB02_2000OL_plot/DB03_2000OL_plot + plot_layout(axis_titles = "collect", guides = "collect", design = "AA\nBB\nCC")


```

## DELAWARE BAY- mostly OL

```{r}
## OL BANDS
#DB01
DB01_OL <- read.csv("Z:/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB01/OL/DB01_OL.csv")
DB01_OL <- DB01_OL[-c(1)]
DB01_OL$UTC <- as.POSIXct(DB01_OL$UTC, format= "%m/%d/%Y %H", tz = "GMT")

#DB02
DB02_OL <- read.csv("Z:/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB02/OL/DB02_OL.csv")
DB02_OL$UTC <- as.POSIXct(DB02_OL$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")

#DB03
DB03_OL <- read.csv("Z:/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB03/OL/DB03_OL_missing2022.csv")
DB03_OL$UTC <- as.POSIXct(DB03_OL$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")


## HMD FULL FILES

#DB01
DB01_202306_Folder <- paste0("/home/asmith/PassiveAcoustics/DETECTOR_OUTPUT/PYTHON_SOUNDSCAPE_PYPAM/Raw/NEFSC_DE/NEFSC_DE_202306_DB01/NC")
DB01_202306_Files <- list.files(DB01_202306_Folder, pattern='nc$', full.names=TRUE)
DB01_202306_HMD = loadSoundscapeData(DB01_202306_Files, timeBin = "1hour")


write_csv(DB01_202306_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "DB01_202306_HMD.csv")) #saving to personal folder, then need to switch to server so everything is together

DB03 <- DB03_202301%>%
  full_join(DB03_202306)%>%
  full_join(DB03_202311)%>%
  full_join(DB03_202405)
DB01_202207 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB01/HMD/202207_DB01.csv")

```

## EASTERN SEABOARD

```{r}

## HMD FULL FILES
#ES01
ES01_202310_Folder <- paste0("/home/asmith/PassiveAcoustics/DETECTOR_OUTPUT/PYTHON_SOUNDSCAPE_PYPAM/Raw/NEFSC_VA/NEFSC_VA_202310_ES01/NC")
ES01_202310_Files <- list.files(ES01_202310_Folder, pattern='nc$', full.names=TRUE)
ES01_202310_HMD = loadSoundscapeData(ES01_202310_Files, timeBin = "1hour")

write_csv(ES01_202310_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "ES01_202310.csv"))

#ES02
ES02_202310_Folder <- paste0("/home/asmith/PassiveAcoustics/DETECTOR_OUTPUT/PYTHON_SOUNDSCAPE_PYPAM/Raw/NEFSC_VA/NEFSC_VA_202310_ES02/NC")
ES02_202310_Files <- list.files(ES02_202310_Folder, pattern='nc$', full.names=TRUE)
ES02_202310_HMD = loadSoundscapeData(ES02_202310_Files, timeBin = "1hour")

write_csv(ES02_202310_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "ES02_202310.csv"))

#ES03
ES03_202310_Folder <- paste0("/home/asmith/PassiveAcoustics/DETECTOR_OUTPUT/PYTHON_SOUNDSCAPE_PYPAM/Raw/NEFSC_VA/NEFSC_VA_202310_ES03/NC")
ES03_202310_Files <- list.files(ES03_202310_Folder, pattern='nc$', full.names=TRUE)
ES03_202310_HMD = loadSoundscapeData(ES03_202310_Files, timeBin = "1hour")

write_csv(ES03_202310_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "ES03_202310.csv"))

```

## CHESAPEAKE BAY

```{r}
## HMD FULL FILES
#CB01
CB01_202212_Folder <- paste0("/home/asmith/PassiveAcoustics/DETECTOR_OUTPUT/PYTHON_SOUNDSCAPE_PYPAM/Raw/NEFSC_VA/NEFSC_VA_202212_CB01/NC")
CB01_202212_Files <- list.files(CB01_202212_Folder, pattern='nc$', full.names=TRUE)
CB01_202212_HMD = loadSoundscapeData(CB01_202212_Files, timeBin = "1hour")


write_csv(CB01_202212_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "CB01_202212.csv"))

#CB03
CB03_202311_Folder <- paste0("/home/asmith/PassiveAcoustics/DETECTOR_OUTPUT/PYTHON_SOUNDSCAPE_PYPAM/Raw/NEFSC_VA/NEFSC_VA_202311_CB01/NC")
CB03_202311_Files <- list.files(CB03_202311_Folder, pattern='nc$', full.names=TRUE)
CB03_202311_HMD = loadSoundscapeData(CB03_202311_Files, timeBin = "1hour")


write_csv(CB03_202311_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "CB03_202311.csv"))

```

## LOADING IN ALL HMD FILES- DB

```{r}
#DB01
DB01_202207 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB01/HMD/202207_DB01.csv")
DB01_202207$UTC <- as.POSIXct(DB01_202207$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB01_202301 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB01/HMD/202301_DB01.csv")
DB01_202301$UTC <- as.POSIXct(DB01_202301$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB01_202306 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB01/HMD/202306_DB01.csv")
DB01_202306$UTC <- as.POSIXct(DB01_202306$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB01_202311 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB01/HMD/202311_DB01.csv")
DB01_202311$UTC <- as.POSIXct(DB01_202311$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB01_202405 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB01/HMD/202405_DB01.csv")
DB01_202405$UTC <- as.POSIXct(DB01_202405$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")

DB01_HMD <- DB01_202207 %>%
  full_join(DB01_202301)%>%
  full_join(DB01_202306)%>%
  full_join(DB01_202311)%>%
  full_join(DB01_202405)
write_csv(DB01_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "DB01_HMD.csv"))

DB01_HMD <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB01/HMD/DB01_HMD.csv")

#DB02
DB02_202207 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB02/HMD/202207_DB02.csv")
DB02_202207$UTC <- as.POSIXct(DB02_202207$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB02_202301 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB02/HMD/202301_DB02.csv")
DB02_202301$UTC <- as.POSIXct(DB02_202301$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB02_202306 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB02/HMD/202306_DB02.csv")
DB02_202306$UTC <- as.POSIXct(DB02_202306$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB02_202311 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB02/HMD/202311_DB02.csv")
DB02_202311$UTC <- as.POSIXct(DB02_202311$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB02_202405 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB02/HMD/202405_DB02.csv")
DB02_202405$UTC <- as.POSIXct(DB02_202405$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")

DB02_HMD <- DB02_202207 %>%
  full_join(DB02_202301)%>%
  full_join(DB02_202306)%>%
  full_join(DB02_202311)%>%
  full_join(DB02_202405)

write_csv(DB02_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "DB02_HMD.csv"))


#DB03
DB03_202207 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB03/HMD/202207_DB03.csv")
DB03_202207$UTC <- as.POSIXct(DB03_202207$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB03_202301 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB03/HMD/202301_DB03.csv")
DB03_202301$UTC <- as.POSIXct(DB03_202301$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB03_202306 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB03/HMD/202306_DB03.csv")
DB03_202306$UTC <- as.POSIXct(DB03_202306$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB03_202311 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB03/HMD/202311_DB03.csv")
DB03_202311$UTC <- as.POSIXct(DB03_202311$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
DB03_202405 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/DB03/HMD/202405_DB03.csv")
DB03_202405$UTC <- as.POSIXct(DB03_202405$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")

DB03_HMD <- DB03_202207 %>%
  full_join(DB03_202301)%>%
  full_join(DB03_202306)%>%
  full_join(DB03_202311)%>%
  full_join(DB03_202405)

write_csv(DB03_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "DB03_HMD.csv"))

```

## LOADING IN ALL HMD FILES- ES

```{r}

#ES01
ES01_202310 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/ES01/HMD/202310_ES01.csv")
ES01_202310$UTC <- as.POSIXct(ES01_202310$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
ES01_202404 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/ES01/HMD/202404_ES01.csv")
ES01_202404$UTC <- as.POSIXct(ES01_202404$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")

ES01_HMD <- ES01_202310 %>%
  full_join(ES01_202404)

write_csv(ES01_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "ES01_HMD.csv"))

#ES02
ES02_202310 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/ES02/HMD/202310_ES02.csv")
ES02_202310$UTC <- as.POSIXct(ES02_202310$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
ES02_202404 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/ES02/HMD/202404_ES02.csv")
ES02_202404$UTC <- as.POSIXct(ES02_202404$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")

ES02_HMD <- ES02_202310 %>%
  full_join(ES02_202404)

write_csv(ES02_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "ES02_HMD.csv"))

#ES03
ES03_202310 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/ES03/HMD/202310_ES03.csv")
ES03_202310$UTC <- as.POSIXct(ES03_202310$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
ES03_202404 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/ES03/HMD/202404_ES03.csv")
ES03_202404$UTC <- as.POSIXct(ES03_202404$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")

ES03_HMD <- ES03_202310 %>%
  full_join(ES03_202404)

write_csv(ES03_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "ES03_HMD.csv"))

```

## LOADING IN ALL HMD FILES- CB

```{r}
#CB01

CB01_202206 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB01/HMD/202206_CB01.csv")
CB01_202206$UTC <- as.POSIXct(CB01_202206$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB01_202212 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB01/HMD/202212_CB01.csv")
CB01_202212$UTC <- as.POSIXct(CB01_202212$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB01_202306 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB01/HMD/202306_CB01.csv")
CB01_202306$UTC <- as.POSIXct(CB01_202306$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB01_202311 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB01/HMD/202311_CB01.csv")
CB01_202311$UTC <- as.POSIXct(CB01_202311$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB01_202405 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB01/HMD/202405_CB01.csv")
CB01_202405$UTC <- as.POSIXct(CB01_202405$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")

CB01_HMD <- CB01_202206 %>%
  full_join(CB01_202212)%>%
  full_join(CB01_202306)%>%
  full_join(CB01_202311)%>%
  full_join(CB01_202405)
write_csv(CB01_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "CB01_HMD.csv"))

#CB02

CB02_202206 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB02/HMD/202206_CB02.csv")
CB02_202206$UTC <- as.POSIXct(CB02_202206$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB02_202306 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB02/HMD/202306_CB02.csv")
CB02_202306$UTC <- as.POSIXct(CB01_202306$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB02_202311 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB02/HMD/202311_CB02.csv")
CB02_202311$UTC <- as.POSIXct(CB02_202311$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB02_202405 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB02/HMD/202405_CB02.csv")
CB02_202405$UTC <- as.POSIXct(CB02_202405$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")

CB02_HMD <- CB02_202206 %>%
  full_join(CB02_202306)%>%
  full_join(CB02_202311)%>%
  full_join(CB02_202405)
write_csv(CB02_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "CB02_HMD.csv"))

#CB03

CB03_202206 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB03/HMD/202206_CB03.csv")
CB03_202206$UTC <- as.POSIXct(CB03_202206$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB03_202212 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB03/HMD/202212_CB03.csv")
CB03_202212$UTC <- as.POSIXct(CB03_202212$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB03_202306 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB03/HMD/202306_CB03.csv")
CB03_202306$UTC <- as.POSIXct(CB03_202306$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB03_202311 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB03/HMD/202311_CB03.csv")
CB03_202311$UTC <- as.POSIXct(CB03_202311$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")
CB03_202405 <- read.csv("/home/asmith/PassiveAcoustics/DATA_ANALYSIS/PUBLICATIONS/MANUSCRIPTS/Smith-et-al_TBD-Mid-Atl-Soundscapes/Output_Files_and_Results/CB03/HMD/202405_CB03.csv")
CB03_202405$UTC <- as.POSIXct(CB03_202405$UTC, format= "%Y-%m-%dT%H:%M:%SZ", tz = "GMT")

CB03_HMD <- CB03_202206 %>%
  full_join(CB03_202212)%>%
  full_join(CB03_202306)%>%
  full_join(CB03_202311)%>%
  full_join(CB03_202405)

write.csv(CB03_HMD, file = paste0("/home/asmith/Anne.Smith/GitHub/Mid_Atl_Soundscape/data", "CB03_HMD.csv"))



```
